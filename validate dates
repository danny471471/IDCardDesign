
create or replace
FUNCTION VALIDATE_DATES_REUIM_TEST
(
TMP_EFF_DATE          POA.PADRS_EFCTV_DT%TYPE,
TMP_TERM_DATE         POA.PADRS_TRMNTN_DT%TYPE, 
PROV_TRMNTN_RSN_CODE  POA.PADRS_TRMNTN_RSN_CD%TYPE,
PROV_TRMNTN_DT        POA.PADRS_TRMNTN_DT%TYPE
) 
RETURN DATE_VALIDATION_RESULT
AS
val_result DATE_VALIDATION_RESULT;
BEGIN
--EFF DATER : 01-NOV-09
--EX TERM DATE: 31/12/9999
--INCMING TERM DATE:31/12/2020
  IF PROV_TRMNTN_DT < TMP_TERM_DATE
    THEN
      IF TMP_EFF_DATE < PROV_TRMNTN_DT
        THEN
          val_result := DATE_VALIDATION_RESULT(PROV_TRMNTN_DT, PROV_TRMNTN_RSN_CODE, 'Y' );
      ELSE
          val_result := DATE_VALIDATION_RESULT(TMP_EFF_DATE, '297', 'Y' );
      END IF;
  ELSE
      val_result := DATE_VALIDATION_RESULT(PROV_TRMNTN_DT, PROV_TRMNTN_RSN_CODE, 'N' );
  END IF;

RETURN val_result;
END;
